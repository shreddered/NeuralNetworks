# Лабораторная работа 1

За обучение нейрона отвечает функция `train`, имеющая следующую сигнатуру:

```haskell
train :: Double                 -- learning rate
      -> ActivationFunction     -- activation function
      -> [Double]               -- original function
      -> [([Double], [Double])] -- [(weights, output)]
```

`ActivationFunction` - вспомогательный тип, в котором передаётся информация о функции активации (сама функция, её производная и функция для получения реального выхода):
```haskell
data ActivationFunction = ActivationFunction
    { primary    :: Double -> Double
    , derivative :: Double -> Double
    , out        :: Double -> Double
    }
```

Все функции для выполнения расчётов определены в модуле [Data.Neuron](src/Data/Neuron.hs).

[Точка входа](app/Main.hs) содержит лишь обработку полученных результатов.

## Задание 1

Промежуточные результаты (таблица с весами по окончании эпохи, реальным выходом и числом ошибок):

```bash
 0.0000, 0.0000, 0.0000, 0.3000, 0.3000	1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0	 2
 0.0000, 0.0000, 0.0000, 0.6000, 0.6000	1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0	 2
-0.3000,-0.3000,-0.3000, 0.6000, 0.6000	1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1	 1
 0.0000,-0.6000,-0.3000, 0.6000, 0.6000	0,1,1,1,0,1,1,1,1,1,1,1,1,0,0,1	 3
 0.3000,-0.6000,-0.3000, 0.9000, 0.6000	1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0	 5
 0.3000,-0.6000,-0.6000, 0.9000, 0.9000	1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,0	 4
 0.3000,-0.9000,-0.6000, 0.9000, 0.6000	1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,1	 2
 0.6000,-0.9000,-0.6000, 0.9000, 0.9000	1,1,1,1,0,1,1,1,0,1,1,1,1,0,1,0	 5
 0.6000,-0.9000,-0.9000, 0.9000, 0.6000	1,1,1,1,1,1,1,1,0,1,1,1,0,1,0,1	 2
 0.9000,-0.9000,-0.6000, 1.2000, 0.6000	1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,0	 3
 0.9000,-0.9000,-0.6000, 1.5000, 0.6000	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0	 2
 0.6000,-1.2000,-0.9000, 1.5000, 0.6000	1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0	 3
 0.9000,-1.2000,-0.9000, 1.5000, 0.6000	1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0	 5
 0.9000,-1.2000,-1.2000, 1.5000, 0.6000	1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,0	 4
 1.2000,-1.2000,-0.9000, 1.5000, 0.9000	1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0	 3
 0.9000,-1.5000,-1.2000, 1.5000, 0.6000	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 1.2000,-1.5000,-1.2000, 1.5000, 0.6000	1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0	 5
 1.5000,-1.2000,-1.2000, 1.5000, 0.9000	1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,0	 3
 1.2000,-1.5000,-1.5000, 1.5000, 0.6000	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 1.5000,-1.5000,-1.2000, 1.5000, 0.9000	1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0	 3
 1.5000,-1.5000,-1.2000, 1.5000, 1.2000	1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0	 2
 1.2000,-1.8000,-1.5000, 1.5000, 0.9000	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 1.5000,-1.8000,-1.5000, 1.5000, 0.6000	1,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1	 3
 1.8000,-1.5000,-1.5000, 1.5000, 0.9000	1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,0	 3
 1.8000,-1.5000,-1.5000, 1.5000, 1.2000	1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0	 2
 1.5000,-1.8000,-1.8000, 1.5000, 0.9000	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 1.8000,-1.8000,-1.5000, 1.5000, 1.2000	1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0	 3
 1.8000,-1.8000,-1.5000, 1.5000, 1.5000	1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0	 2
 1.5000,-2.1000,-1.8000, 1.5000, 1.2000	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 1.8000,-2.1000,-1.8000, 1.5000, 0.9000	1,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1	 3
 2.1000,-1.8000,-1.8000, 1.5000, 1.2000	1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,0	 3
 2.1000,-1.8000,-1.8000, 1.5000, 1.5000	1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0	 2
 1.8000,-2.1000,-2.1000, 1.5000, 1.2000	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 2.1000,-2.1000,-1.8000, 1.5000, 1.2000	1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,1	 1
 2.1000,-2.1000,-1.8000, 1.5000, 1.2000	1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1	 0
```

Зависимость количества ошибок от номера эпохи:

![threshold plot](images/plot1.png)

## Задание 2

Промежуточные результаты (таблица с весами по окончании эпохи, реальным выходом и числом ошибок):

```bash
-0.0267,-0.0267,-0.0267, 0.1233, 0.1233	1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0	 2
 0.1214,-0.0285,-0.0285, 0.2707, 0.2707	0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0	 3
-0.0280,-0.1779,-0.1779, 0.2707, 0.2707	1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1	 1
 0.1220,-0.3273,-0.1778, 0.2707, 0.2707	0,1,1,1,0,1,1,1,1,1,1,1,1,0,0,1	 3
 0.2678,-0.3311,-0.1815, 0.4102, 0.2607	1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0	 5
 0.2530,-0.3459,-0.3457, 0.3956, 0.3960	1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,0	 4
 0.2610,-0.4865,-0.3377, 0.3956, 0.2553	1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,1	 2
 0.4094,-0.4872,-0.3384, 0.3956, 0.2553	1,1,1,1,0,1,1,1,0,1,1,1,1,0,0,1	 3
 0.5609,-0.3358,-0.3361, 0.5451, 0.2577	1,1,1,1,1,1,1,1,0,1,1,1,0,1,0,0	 3
 0.4140,-0.4826,-0.4829, 0.5451, 0.1109	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 0.5722,-0.4738,-0.3247, 0.5540, 0.2576	1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0	 3
 0.5723,-0.4737,-0.3246, 0.7039, 0.2577	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0	 2
 0.3945,-0.6515,-0.5025, 0.6760, 0.2298	1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0	 3
 0.5148,-0.6794,-0.5304, 0.6492, 0.2030	1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0	 5
 0.6437,-0.7005,-0.5514, 0.6264, 0.1802	1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0	 5
 0.8071,-0.5371,-0.5376, 0.6403, 0.3299	1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,0	 3
 0.6577,-0.6865,-0.6870, 0.6403, 0.1805	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 0.8108,-0.6833,-0.5339, 0.6435, 0.3264	1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0	 3
 0.8189,-0.6752,-0.5258, 0.6516, 0.4764	1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0	 2
 0.6702,-0.8239,-0.6744, 0.6516, 0.3278	1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1	 1
 0.8217,-0.8224,-0.6730, 0.6516, 0.1793	1,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1	 3
 0.9813,-0.6628,-0.6634, 0.6612, 0.3278	1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,0	 3
 0.8453,-0.7987,-0.7993, 0.5253, 0.3278	1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1	 1
 0.8453,-0.7987,-0.7993, 0.5253, 0.3278	1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1	 0
```

Зависимость количества ошибок от номера эпохи:

![logistic plot](images/plot2.png)
